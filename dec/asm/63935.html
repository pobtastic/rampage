<!DOCTYPE html>
<html>
<head>
<title>Rampage: Routine at 63935</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-wide.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="63873.html">63873</a>
</td>
<td class="up">Up: <a href="../maps/all.html#63935">Map</a></td>
<td class="next">
Next: <a href="64168.html">64168</a>
</td>
</tr>
</table>
<div class="description">63935: Change Controls</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="63766.html">SelectionScreen</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">ChangeControls</td>
<td class="address-2"><span id="63935"></span>63935</td>
<td class="instruction">CALL <a href="64468.html">GetKeypress</a></td>
<td class="comment-1" rowspan="1">Call <a href="64468.html">GetKeypress</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63938"></span>63938</td>
<td class="instruction">JR NZ,<a href="63935.html#63935">ChangeControls</a></td>
<td class="comment-1" rowspan="1">Loop back to <a href="63935.html">ChangeControls</a> until a key is pressed.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="63940"></span>
<div class="comments">
<div class="paragraph">
Reset the control type for all monsters.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63940"></span>63940</td>
<td class="instruction">LD A,255</td>
<td class="comment-1" rowspan="4">Write 255 to: <ul class="">
<li>*<a href="53202.html#53216">George_Control_Type</a></li>
<li>*<a href="53249.html#53263">Lizzy_Control_Type</a></li>
<li>*<a href="53296.html#53310">Ralph_Control_Type</a></li>
</ul></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63942"></span>63942</td>
<td class="instruction">LD (53216),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63945"></span>63945</td>
<td class="instruction">LD (53263),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63948"></span>63948</td>
<td class="instruction">LD (53310),A</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="63951"></span>
<div class="comments">
<div class="paragraph">
Set up a count for how many players will be using the keyboard (see <a href="63935.html#64083">ChangeControls_Keyboard</a>).
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63951"></span>63951</td>
<td class="instruction">LD A,3</td>
<td class="comment-1" rowspan="2">Write 3 to *<a href="64346.html">Keyboard_Control_Count</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63953"></span>63953</td>
<td class="instruction">LD (64346),A</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="63956"></span>
<div class="comments">
<div class="paragraph">
Create a "change controls" page for George:
</div>
<div class="paragraph">
<img alt="controls-george" src="../../images/scr/controls-george.png" />
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63956"></span>63956</td>
<td class="instruction">CALL <a href="64398.html">CreateAdminPageTemplate</a></td>
<td class="comment-1" rowspan="1">Call <a href="64398.html">CreateAdminPageTemplate</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63959"></span>63959</td>
<td class="instruction">LD HL,53343</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="53343.html">Messaging_George</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63962"></span>63962</td>
<td class="instruction">LD IX,53202</td>
<td class="comment-1" rowspan="1"><span class="register">IX</span>=<a href="53202.html">George_State</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63966"></span>63966</td>
<td class="instruction">CALL <a href="63935.html#63996">ChangeControls_Action</a></td>
<td class="comment-1" rowspan="1">Call <a href="63935.html#63996">ChangeControls_Action</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="63969"></span>
<div class="comments">
<div class="paragraph">
Create a "change controls" page for Lizzy.
</div>
<div class="paragraph">
<img alt="controls-lizzy" src="../../images/scr/controls-lizzy.png" />
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63969"></span>63969</td>
<td class="instruction">CALL <a href="64398.html">CreateAdminPageTemplate</a></td>
<td class="comment-1" rowspan="1">Call <a href="64398.html">CreateAdminPageTemplate</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63972"></span>63972</td>
<td class="instruction">LD IX,53249</td>
<td class="comment-1" rowspan="1"><span class="register">IX</span>=<a href="53249.html">Lizzy_State</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63976"></span>63976</td>
<td class="instruction">LD HL,53357</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="53357.html">Messaging_Lizzy</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63979"></span>63979</td>
<td class="instruction">CALL <a href="63935.html#63996">ChangeControls_Action</a></td>
<td class="comment-1" rowspan="1">Call <a href="63935.html#63996">ChangeControls_Action</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="63982"></span>
<div class="comments">
<div class="paragraph">
Create a "change controls" page for Ralph.
</div>
<div class="paragraph">
<img alt="controls-ralph" src="../../images/scr/controls-ralph.png" />
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63982"></span>63982</td>
<td class="instruction">CALL <a href="64398.html">CreateAdminPageTemplate</a></td>
<td class="comment-1" rowspan="1">Call <a href="64398.html">CreateAdminPageTemplate</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63985"></span>63985</td>
<td class="instruction">LD IX,53296</td>
<td class="comment-1" rowspan="1"><span class="register">IX</span>=<a href="53296.html">Ralph_State</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63989"></span>63989</td>
<td class="instruction">LD HL,53371</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="53371.html">Messaging_Ralph</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63992"></span>63992</td>
<td class="instruction">CALL <a href="63935.html#63996">ChangeControls_Action</a></td>
<td class="comment-1" rowspan="1">Call <a href="63935.html#63996">ChangeControls_Action</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63995"></span>63995</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="63996"></span>
<div class="comments">
<div class="paragraph">
Print the monster name.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">ChangeControls_Action</td>
<td class="address-2"><span id="63996"></span>63996</td>
<td class="instruction">LD BC,2052</td>
<td class="comment-1" rowspan="1"><span class="register">BC</span>=2052 (screen co-ordinates).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="63999"></span>63999</td>
<td class="instruction">CALL <a href="64347.html">PrintString</a></td>
<td class="comment-1" rowspan="1">Call <a href="64347.html">PrintString</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="64002"></span>
<div class="comments">
<div class="paragraph">
Prints "SELECT THE CONTROLS FOR".
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64002"></span>64002</td>
<td class="instruction">LD HL,53461</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="53461.html">Messaging_ChangeControls</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64005"></span>64005</td>
<td class="instruction">LD BC,771</td>
<td class="comment-1" rowspan="1"><span class="register">BC</span>=771 (screen co-ordinates).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64008"></span>64008</td>
<td class="instruction">CALL <a href="64347.html">PrintString</a></td>
<td class="comment-1" rowspan="1">Call <a href="64347.html">PrintString</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64011"></span>64011</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1">Move onto the start of the next message.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64012"></span>64012</td>
<td class="instruction">LD BC,1282</td>
<td class="comment-1" rowspan="1"><span class="register">BC</span>=1282 (screen co-ordinates).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64015"></span>64015</td>
<td class="instruction">CALL <a href="64347.html">PrintString</a></td>
<td class="comment-1" rowspan="1">Call <a href="64347.html">PrintString</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="64018"></span>
<div class="comments">
<div class="paragraph">
Programmatically display all the <a href="53555.html">Messaging_ChooseControls</a> options.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64018"></span>64018</td>
<td class="instruction">LD HL,53555</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="53555.html">Messaging_ChooseControls</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64021"></span>64021</td>
<td class="instruction">XOR A</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=0 (option counter).</td>
</tr>
<tr>
<td class="asm-label">ChangeControls_PrintLoop</td>
<td class="address-2"><span id="64022"></span>64022</td>
<td class="instruction">PUSH AF</td>
<td class="comment-1" rowspan="1">Stash the option counter on the stack.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="64023"></span>
<div class="comments">
<div class="paragraph">
The options are two lines apart and start from row 11.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64023"></span>64023</td>
<td class="instruction">ADD A,A</td>
<td class="comment-1" rowspan="3"><span class="register">B</span>=11+<span class="register">A</span>*2.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64024"></span>64024</td>
<td class="instruction">ADD A,11</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64026"></span>64026</td>
<td class="instruction">LD B,A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64027"></span>64027</td>
<td class="instruction">LD C,1</td>
<td class="comment-1" rowspan="1"><span class="register">C</span>=1 (screen co-ordinates).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64029"></span>64029</td>
<td class="instruction">CALL <a href="64347.html">PrintString</a></td>
<td class="comment-1" rowspan="1">Call <a href="64347.html">PrintString</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64032"></span>64032</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1">Move onto the start of the next message.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64033"></span>64033</td>
<td class="instruction">POP AF</td>
<td class="comment-1" rowspan="1">Restore the option counter from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64034"></span>64034</td>
<td class="instruction">INC A</td>
<td class="comment-1" rowspan="1">Increment the option counter by one.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="64035"></span>
<div class="comments">
<div class="paragraph">
Note we only show five options "N - NO MONSTER" is never used.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64035"></span>64035</td>
<td class="instruction">CP 5</td>
<td class="comment-1" rowspan="2">Jump to <a href="63935.html#64022">ChangeControls_PrintLoop</a> until the option counter is equal to 5.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64037"></span>64037</td>
<td class="instruction">JR NZ,<a href="63935.html#64022">ChangeControls_PrintLoop</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="64039"></span>
<div class="comments">
<div class="paragraph">
Prints the last line manually "    CONTROLLED" (as it's the second line of the option before it).
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64039"></span>64039</td>
<td class="instruction">LD BC,5121</td>
<td class="comment-1" rowspan="1"><span class="register">BC</span>=5121 (screen co-ordinates).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64042"></span>64042</td>
<td class="instruction">CALL <a href="64347.html">PrintString</a></td>
<td class="comment-1" rowspan="1">Call <a href="64347.html">PrintString</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="64045"></span>
<div class="comments">
<div class="paragraph">
Output to the screen buffer.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64045"></span>64045</td>
<td class="instruction">CALL <a href="54788.html">ScreenBuffer_Update</a></td>
<td class="comment-1" rowspan="1">Call <a href="54788.html">ScreenBuffer_Update</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64048"></span>64048</td>
<td class="instruction">CALL <a href="54776.html">AttributeBuffer_Update</a></td>
<td class="comment-1" rowspan="1">Call <a href="54776.html">AttributeBuffer_Update</a>.</td>
</tr>
<tr>
<td class="asm-label">ChangeControls_Input</td>
<td class="address-2"><span id="64051"></span>64051</td>
<td class="instruction">CALL <a href="56768.html">ChooseControlType</a></td>
<td class="comment-1" rowspan="1">Call <a href="56768.html">ChooseControlType</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64054"></span>64054</td>
<td class="instruction">JR NZ,<a href="63935.html#64051">ChangeControls_Input</a></td>
<td class="comment-1" rowspan="1">Loop back to <a href="63935.html#64051">ChangeControls_Input</a> until an option has been selected.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="64056"></span>
<div class="comments">
<div class="paragraph">
Process the selected option.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64056"></span>64056</td>
<td class="instruction">LD A,D</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=control option.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64057"></span>64057</td>
<td class="instruction">CP 255</td>
<td class="comment-1" rowspan="2">Jump to <a href="63935.html#64051">ChangeControls_Input</a> if the control option is invalid.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64059"></span>64059</td>
<td class="instruction">JR Z,<a href="63935.html#64051">ChangeControls_Input</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64061"></span>64061</td>
<td class="instruction">CP 17</td>
<td class="comment-1" rowspan="2">Jump to <a href="63935.html#64083">ChangeControls_Keyboard</a> if "K" was pressed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64063"></span>64063</td>
<td class="instruction">JR Z,<a href="63935.html#64083">ChangeControls_Keyboard</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64065"></span>64065</td>
<td class="instruction">CP 36</td>
<td class="comment-1" rowspan="2">Jump to <a href="63935.html#64120">ChangeControls_Sinclair1</a> if "1" was pressed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64067"></span>64067</td>
<td class="instruction">JR Z,<a href="63935.html#64120">ChangeControls_Sinclair1</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64069"></span>64069</td>
<td class="instruction">CP 28</td>
<td class="comment-1" rowspan="2">Jump to <a href="63935.html#64124">ChangeControls_Sinclair2</a> if "2" was pressed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64071"></span>64071</td>
<td class="instruction">JR Z,<a href="63935.html#64124">ChangeControls_Sinclair2</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64073"></span>64073</td>
<td class="instruction">CP 20</td>
<td class="comment-1" rowspan="2">Jump to <a href="63935.html#64128">ChangeControls_Kempston</a> if "3" was pressed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64075"></span>64075</td>
<td class="instruction">JR Z,<a href="63935.html#64128">ChangeControls_Kempston</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64077"></span>64077</td>
<td class="instruction">CP 15</td>
<td class="comment-1" rowspan="2">Jump to <a href="63935.html#64139">ChangeControls_Computer</a> if "C" was pressed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64079"></span>64079</td>
<td class="instruction">JR Z,<a href="63935.html#64139">ChangeControls_Computer</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64081"></span>64081</td>
<td class="instruction">JR <a href="63935.html#64051">ChangeControls_Input</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="63935.html#64051">ChangeControls_Input</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="64083"></span>
<div class="comments">
<div class="paragraph">
Set "Keyboard" as the control method.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">ChangeControls_Keyboard</td>
<td class="address-2"><span id="64083"></span>64083</td>
<td class="instruction">CALL <a href="64168.html">UserDefinedKeys</a></td>
<td class="comment-1" rowspan="1">Call <a href="64168.html">UserDefinedKeys</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="64086"></span>
<div class="comments">
<div class="paragraph">
Each set of user defined keys will have a different control method ID starting from 4.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64086"></span>64086</td>
<td class="instruction">LD A,(64346)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=*<a href="64346.html">Keyboard_Control_Count</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64089"></span>64089</td>
<td class="instruction">INC A</td>
<td class="comment-1" rowspan="1">Increment <span class="register">A</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64090"></span>64090</td>
<td class="instruction">LD (64346),A</td>
<td class="comment-1" rowspan="1">Write <span class="register">A</span> to *<a href="64346.html">Keyboard_Control_Count</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64093"></span>64093</td>
<td class="instruction">LD (IX+14),A</td>
<td class="comment-1" rowspan="1">Write <span class="register">A</span> to *<span class="register">IX</span>+14 (monster control type).</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="64096"></span>
<div class="comments">
<div class="paragraph">
Calculate where the user defined keys will be stored.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64096"></span>64096</td>
<td class="instruction">SUB 4</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>-=4.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64098"></span>64098</td>
<td class="instruction">ADD A,A</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>*=2.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64099"></span>64099</td>
<td class="instruction">LD D,A</td>
<td class="comment-1" rowspan="1"><span class="register">D</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64100"></span>64100</td>
<td class="instruction">ADD A,A</td>
<td class="comment-1" rowspan="2"><span class="register">A</span>*=4.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64101"></span>64101</td>
<td class="instruction">ADD A,A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64102"></span>64102</td>
<td class="instruction">ADD A,D</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>+=<span class="register">D</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64103"></span>64103</td>
<td class="instruction">LD H,0</td>
<td class="comment-1" rowspan="2">Create an offset using <span class="register">HL</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64105"></span>64105</td>
<td class="instruction">LD L,A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64106"></span>64106</td>
<td class="instruction">LD DE,51280</td>
<td class="comment-1" rowspan="2"><span class="register">HL</span>+=<a href="51280.html">UserDefinedKeys_Set1</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64109"></span>64109</td>
<td class="instruction">ADD HL,DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64110"></span>64110</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1">Exchange the <span class="register">DE</span> and <span class="register">HL</span> registers.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64111"></span>64111</td>
<td class="instruction">LD HL,64334</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="64334.html">UserDefinedKeys_Buffer</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64114"></span>64114</td>
<td class="instruction">LD BC,10</td>
<td class="comment-1" rowspan="1"><span class="register">BC</span>=0010.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64117"></span>64117</td>
<td class="instruction">LDIR</td>
<td class="comment-1" rowspan="1">Copy selected keys to monster config.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64119"></span>64119</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="64120"></span>
<div class="comments">
<div class="paragraph">
Set "Sinclair Interface 2" (port 1) as the control method.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">ChangeControls_Sinclair1</td>
<td class="address-2"><span id="64120"></span>64120</td>
<td class="instruction">LD D,2</td>
<td class="comment-1" rowspan="1"><span class="register">D</span>=2.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64122"></span>64122</td>
<td class="instruction">JR <a href="63935.html#64130">SetControlType</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="63935.html#64130">SetControlType</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="64124"></span>
<div class="comments">
<div class="paragraph">
Set "Sinclair Interface 2" (port 2) as the control method.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">ChangeControls_Sinclair2</td>
<td class="address-2"><span id="64124"></span>64124</td>
<td class="instruction">LD D,1</td>
<td class="comment-1" rowspan="1"><span class="register">D</span>=1.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64126"></span>64126</td>
<td class="instruction">JR <a href="63935.html#64130">SetControlType</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="63935.html#64130">SetControlType</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="64128"></span>
<div class="comments">
<div class="paragraph">
Set "Kempston Joystick" as the control method.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">ChangeControls_Kempston</td>
<td class="address-2"><span id="64128"></span>64128</td>
<td class="instruction">LD D,3</td>
<td class="comment-1" rowspan="1"><span class="register">D</span>=3.</td>
</tr>
<tr>
<td class="asm-label">SetControlType</td>
<td class="address-2"><span id="64130"></span>64130</td>
<td class="instruction">CALL <a href="63935.html#64149">CheckExistingControls</a></td>
<td class="comment-1" rowspan="1">Call <a href="63935.html#64149">CheckExistingControls</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64133"></span>64133</td>
<td class="instruction">JR Z,<a href="63935.html#64051">ChangeControls_Input</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="63935.html#64051">ChangeControls_Input</a> if the control type is already selected by another monster.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64135"></span>64135</td>
<td class="instruction">LD (IX+14),D</td>
<td class="comment-1" rowspan="1">Write the control type to *<span class="register">IX</span>+14 (monster control type).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64138"></span>64138</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="64139"></span>
<div class="comments">
<div class="paragraph">
Set "Computer Controlled" as the control method.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">ChangeControls_Computer</td>
<td class="address-2"><span id="64139"></span>64139</td>
<td class="instruction">LD (IX+14),0</td>
<td class="comment-1" rowspan="1">Write 0 to *<span class="register">IX</span>+14 (monster control type).</td>
</tr>
<tr>
<td class="asm-label">ChangeControls_Computer_KeyPress</td>
<td class="address-2"><span id="64143"></span>64143</td>
<td class="instruction">CALL <a href="64468.html">GetKeypress</a></td>
<td class="comment-1" rowspan="1">Call <a href="64468.html">GetKeypress</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64146"></span>64146</td>
<td class="instruction">JR NZ,<a href="63935.html#64143">ChangeControls_Computer_KeyPress</a></td>
<td class="comment-1" rowspan="1">Loop back to <a href="63935.html#64143">ChangeControls_Computer_KeyPress</a> until a key has been pressed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64148"></span>64148</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="64149"></span>
<div class="comments">
<div class="paragraph">
Monsters can't use the same controllers, this is verified here.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">CheckExistingControls</td>
<td class="address-2"><span id="64149"></span>64149</td>
<td class="instruction">LD A,(53216)</td>
<td class="comment-1" rowspan="3">Return if *<a href="53202.html#53216">George_Control_Type</a> is equal to the currently selected control method.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64152"></span>64152</td>
<td class="instruction">CP D</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64153"></span>64153</td>
<td class="instruction">RET Z</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64154"></span>64154</td>
<td class="instruction">LD A,(53263)</td>
<td class="comment-1" rowspan="3">Return if *<a href="53249.html#53263">Lizzy_Control_Type</a> is equal to the currently selected control method.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64157"></span>64157</td>
<td class="instruction">CP D</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64158"></span>64158</td>
<td class="instruction">RET Z</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64159"></span>64159</td>
<td class="instruction">LD A,(53310)</td>
<td class="comment-1" rowspan="3">Return if *<a href="53296.html#53310">Ralph_Control_Type</a> is equal to the currently selected control method.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64162"></span>64162</td>
<td class="instruction">CP D</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64163"></span>64163</td>
<td class="instruction">RET Z</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="64164"></span>
<div class="comments">
<div class="paragraph">
Ensure ZERO flag is not set for the return.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64164"></span>64164</td>
<td class="instruction">LD A,1</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=1.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64166"></span>64166</td>
<td class="instruction">OR A</td>
<td class="comment-1" rowspan="1">Set the bits from <span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="64167"></span>64167</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="63873.html">63873</a>
</td>
<td class="up">Up: <a href="../maps/all.html#63935">Map</a></td>
<td class="next">
Next: <a href="64168.html">64168</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1986 Activision &copy; 2024 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 9.0.</div>
<div class="repository">Link to <a href="https://github.com/pobtastic/rampage/">Source code</a>.</div>
<div><a href="asm/63935.html">Switch to hexadecimal</a>.</div>
</footer>
</body>
</html>